<% if @summary %>
    <p id="summary"><span>Fahrt:</span> <%= link_to @summary %></p>
<% end %>
<table>

  <thead>

    <% unless @summary %>
    <th>Von</th>
    <th>Nach</th>
    <% end %>

    <% if @counterpart %>
      <th><%= @counterpart.to_s.capitalize %></th>
    <% end %>

    <th>Best√§tigt</th>
    <th>Aktionen</th>

  </thead>

  <tbody>

    <% @mitfahrts.each do |fahrt, mitfahrers| %>
      <% span = mitfahrers.size %>
      <% mitfahrers.each.with_index do |mitfahrer, i| %>
        <tr>

          <% unless @summary %>
            <% if i == 0 %>
              <td rowspan="<%= span %>"><%= fahrt.von %></td>
              <td rowspan="<%= span %>"><%= fahrt.nach %></td>
            <% end %>
          <% end %>

          <% if @counterpart %>
            <td><%= mitfahrer_counterpart(mitfahrer) %></td>
          <% end %>

          <td>
            <%= mitfahrer.istBestatigt ? ':y:' : ':n:' %>
            <% if mitfahrer.fahrt.account == current_account %>
              <% if mitfahrer.istBestatigt %>
                <%= link_to ":-1:", mitfahrer_bestaetigen_path(mitfahrer), method: :delete, remote: true %>
              <% else %>
                <%= link_to ":+1:", mitfahrer_bestaetigen_path(mitfahrer), method: :post, remote: true %>
              <% end %>
            <% end %>
          </td>

          <td class="actions">
            <%= link_to "Anzeigen", mitfahrer_path(mitfahrer) %>

            <% if mitfahrer.fahrt.account == current_account %>
              <%= link_to "Bearbeiten", edit_mitfahrer_path(mitfahrer) %>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
